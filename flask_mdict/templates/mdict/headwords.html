{% extends "layout.html" %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{url_for('.static', filename='css/typeahead.css')}}">
<link rel="stylesheet" href="{{url_for('.static', filename='css/mdict.css')}}">
{% endblock %}

{% block subtitle %}All Headwords - {{config.APP_NAME}}{% endblock %}

{% block navmenu %}
    <form method="POST" action="{{url_for('.query_word_all')}}" class="col">
        <div class="input-group">
            {{ form.word(placeholder='word', class='form-control', autocomplete='off') }}
            <div class="input-group-append">
                <button id="btn-search" type="submit" class="btn btn-outline-info" style="z-index:1;">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>
        {{ form.csrf_token }}
    </form>

{% endblock %}

{% block maincontent %}
<ul class="words">
  {% for word in words %}
      <li><a href="{{url_for('.query_word', uuid=uuid, word=word)}}">{{word|safe}}</a></li>
  {% endfor %}
</ul>
{% endblock %}

{% block script %}
{{super()}}
<script src="{{url_for(".static", filename="js/mdict.js")}}"></script>
<script src="{{url_for(".static", filename="js/typeahead.bundle.min.js")}}"></script>
<script type="text/javascript">
    if ("{{message}}") {
        $('#message').modal('show');
    }
/* typeahead */
var dataset_engine = new Bloodhound({
    queryTokenizer: Bloodhound.tokenizers.whitespace,
    datumTokenizer: Bloodhound.tokenizers.whitespace,
    remote: {
        url: '{{url_for('.query_part', part='')}}' + '%QUERY',
        wildcard: '%QUERY',
        transform: function(data){
            return data.suggestion;
        }
    }
});
$('#word').typeahead({
    minLength: 2,
    highlight: true
},
{
    name: 'suggestion',
    limit: 10,
    source: dataset_engine,
    display: function(data) {
        return data;
    }
});
/* dictionary checkbox */
let toggle_url="{{url_for('.mdict_toggle', uuid='')}}";
$('input[name="mdict_enable"]').each((index, element) => {
    element.addEventListener('change', (event) => {
        let url = toggle_url + element.value;
        $.getJSON(url, (data) => {
            // console.log(data);
        });
    });
});

    $('#online_dict').find('a').each(function(index, element) {
        element.href += '{{word}}';
    });
</script>
{% endblock %}
